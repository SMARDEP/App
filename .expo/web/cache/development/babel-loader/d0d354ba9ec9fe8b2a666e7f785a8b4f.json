{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"C:\\\\Users\\\\emanu\\\\Downloads\\\\vendor-app-v3.0 (1)\\\\screens\\\\Orders.js\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React, { useState, useEffect } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Dimensions from \"react-native-web/dist/exports/Dimensions\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport RefreshControl from \"react-native-web/dist/exports/RefreshControl\";\nimport { Block, theme, Text } from \"galio-framework\";\nimport { Language } from \"../constants\";\n\nvar _Dimensions$get = Dimensions.get(\"screen\"),\n    width = _Dimensions$get.width;\n\nimport API from \"./../services/api\";\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport config from \"./../config\";\nimport { LoadingIndicator } from 'react-native-expo-fancy-alerts';\nimport { Checkbox } from 'galio-framework';\nimport moment from \"moment\";\nimport * as Location from 'expo-location';\n\nfunction Orders(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      location = _useState2[0],\n      setLocation = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      errorMsg = _useState4[0],\n      setErrorMsg = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      orders = _useState6[0],\n      setOrders = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      available = _useState8[0],\n      setAvailable = _useState8[1];\n\n  var _useState9 = useState(false),\n      _useState10 = _slicedToArray(_useState9, 2),\n      ordersLoaded = _useState10[0],\n      setOrdersLoaded = _useState10[1];\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      refreshing = _React$useState2[0],\n      setRefreshing = _React$useState2[1];\n\n  var cardContainer = [styles.card, styles.shadow];\n  useEffect(function () {\n    (function _callee() {\n      var _await$Location$reque, status, location;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return _regeneratorRuntime.awrap(Location.requestPermissionsAsync());\n\n            case 2:\n              _await$Location$reque = _context.sent;\n              status = _await$Location$reque.status;\n\n              if (!(status !== 'granted')) {\n                _context.next = 7;\n                break;\n              }\n\n              setErrorMsg('Permission to access location was denied');\n              return _context.abrupt(\"return\");\n\n            case 7:\n              _context.next = 9;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}));\n\n            case 9:\n              location = _context.sent;\n              setLocation(location);\n\n            case 11:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    })();\n  }, []);\n\n  function updateOrderLocation(ordersToUpdate) {\n    if (location != null && location.coords) {\n      ordersToUpdate.forEach(function (orderToUpdate) {\n        API.updateDriverOrderLocation(orderToUpdate.id, location.coords.latitude, location.coords.longitude, function (ordersUpdateResponse) {}, function (errorOrdersUpdateResponse) {});\n      });\n    }\n  }\n\n  useEffect(function () {\n    if (config.DRIVER_APP) {\n      API.getDriverOrders(function (ordersResponse) {\n        setOrders(ordersResponse);\n        updateOrderLocation(ordersResponse.filter(function (e) {\n          return e.last_status[0].alias == \"picked_up\";\n        }));\n        setOrdersLoaded(true);\n        setRefreshing(false);\n      }, function (error) {\n        setOrders([]);\n        setRefreshing(false);\n        setOrdersLoaded(true);\n        alert(error);\n      });\n      API.getDriverStatus(function (statusResponse) {\n        console.log(statusResponse);\n        setAvailable(statusResponse.working + \"\" == \"1\");\n      });\n    }\n\n    if (config.VENDOR_APP) {\n      API.getVendorOrders(function (ordersResponse) {\n        setOrders(ordersResponse);\n        setOrdersLoaded(true);\n        setRefreshing(false);\n      }, function (error) {\n        setOrders([]);\n        setRefreshing(false);\n        setOrdersLoaded(true);\n        alert(error);\n      });\n    } else {\n      API.getClientOrders(function (ordersResponse) {\n        setOrders(ordersResponse);\n        setOrdersLoaded(true);\n        setRefreshing(false);\n      });\n    }\n  }, [refreshing]);\n  var onRefresh = React.useCallback(function () {\n    setRefreshing(true);\n  }, [refreshing]);\n  useEffect(function () {\n    var interval = setInterval(function () {\n      setRefreshing(true);\n    }, 30000);\n    return function () {\n      return clearInterval(interval);\n    };\n  }, []);\n\n  function setActiveStatus(status) {\n    API.setActiveStatus(status, function (statusResponse) {\n      console.log(\"Changed to ->\" + statusResponse);\n      setAvailable(statusResponse);\n    });\n  }\n\n  function renderDriverActionBox(initValue) {\n    if (config.DRIVER_APP) {\n      if (initValue) {\n        return React.createElement(Block, {\n          row: true,\n          card: true,\n          flex: true,\n          style: styles.actioncard,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132,\n            columnNumber: 13\n          }\n        }, React.createElement(Block, {\n          style: {\n            \"some\": available\n          },\n          flex: true,\n          space: \"between\",\n          justifyContent: \"center\",\n          paddingHorizontal: 10,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 133,\n            columnNumber: 17\n          }\n        }, React.createElement(Checkbox, {\n          key: \"true\",\n          onChange: setActiveStatus,\n          initialValue: true,\n          color: \"success\",\n          labelStyle: {\n            color: \"white\"\n          },\n          color: \"success\",\n          checkboxStyle: {\n            margin: 10\n          },\n          label: Language.driverWorkingStatus,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 21\n          }\n        })));\n      } else {\n        return React.createElement(Block, {\n          row: true,\n          card: true,\n          flex: true,\n          style: styles.actioncard,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 13\n          }\n        }, React.createElement(Block, {\n          style: {\n            \"some\": available\n          },\n          flex: true,\n          space: \"between\",\n          justifyContent: \"center\",\n          paddingHorizontal: 10,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 141,\n            columnNumber: 17\n          }\n        }, React.createElement(Checkbox, {\n          key: \"false\",\n          onChange: setActiveStatus,\n          initialValue: false,\n          color: \"success\",\n          labelStyle: {\n            color: \"white\"\n          },\n          color: \"success\",\n          checkboxStyle: {\n            margin: 10\n          },\n          label: Language.driverWorkingStatus,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 142,\n            columnNumber: 21\n          }\n        })));\n      }\n    } else {\n      return null;\n    }\n  }\n\n  function renderOrderItem(item) {\n    return React.createElement(Block, {\n      row: true,\n      card: true,\n      flex: true,\n      style: cardContainer,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 9\n      }\n    }, React.createElement(TouchableOpacity, {\n      onPress: function onPress() {\n        navigation.navigate(\"OrderDetails\", {\n          order: item\n        });\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 11\n      }\n    }, React.createElement(Block, {\n      flex: true,\n      space: \"between\",\n      style: styles.cardDescription,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 14\n      }\n    }, React.createElement(Text, {\n      bold: true,\n      style: styles.cardTitle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }, \"#\", item.id, \" \", item.restorant.name), React.createElement(Text, {\n      muted: true,\n      style: styles.cardTitle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 163,\n        columnNumber: 17\n      }\n    }, Language.created + \": \", moment(item.created_at).format(config.dateTimeFormat)), React.createElement(Text, {\n      muted: true,\n      bold: true,\n      style: styles.cardTitle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 17\n      }\n    }, Language.status + \": \", item.status.length - 1 > -1 ? item.status[item.status.length - 1].name : \"\"), React.createElement(Text, {\n      bold: true,\n      style: styles.cardTitle,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 17\n      }\n    }, parseFloat(item.order_price) + parseFloat(item.delivery_price), config.currencySign))));\n  }\n\n  function renderNoOrders() {\n    if (ordersLoaded && orders.length == 0) {\n      return React.createElement(Text, {\n        muted: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 18\n        }\n      }, Language.no_items);\n    } else {\n      return null;\n    }\n  }\n\n  return React.createElement(Block, {\n    flex: true,\n    center: true,\n    style: styles.home,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 1\n    }\n  }, renderDriverActionBox(available), React.createElement(ScrollView, {\n    showsVerticalScrollIndicator: false,\n    contentContainerStyle: styles.articles,\n    refreshControl: React.createElement(RefreshControl, {\n      refreshing: refreshing,\n      onRefresh: onRefresh,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 15\n      }\n    }),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 185,\n      columnNumber: 1\n    }\n  }, React.createElement(Block, {\n    flex: true,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 192,\n      columnNumber: 17\n    }\n  }, orders.map(function (item) {\n    return renderOrderItem(item);\n  }), renderNoOrders())), React.createElement(LoadingIndicator, {\n    visible: !ordersLoaded,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202,\n      columnNumber: 9\n    }\n  }));\n}\n\nexport default Orders;\nvar styles = StyleSheet.create({\n  cartCheckout: {\n    backgroundColor: \"white\"\n  },\n  listStyle: {\n    padding: theme.SIZES.BASE\n  },\n  home: {\n    width: width\n  },\n  articles: {\n    width: width - theme.SIZES.BASE * 2,\n    paddingVertical: theme.SIZES.BASE\n  },\n  actionButtons: {\n    backgroundColor: '#DCDCDC',\n    paddingHorizontal: 16,\n    paddingTop: 10,\n    paddingBottom: 9.5,\n    borderRadius: 3,\n    shadowColor: \"rgba(0, 0, 0, 0.1)\",\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowRadius: 4,\n    shadowOpacity: 1\n  },\n  card: {\n    backgroundColor: theme.COLORS.WHITE,\n    marginVertical: theme.SIZES.BASE,\n    borderWidth: 0,\n    minHeight: 114,\n    marginBottom: 16\n  },\n  actioncard: {\n    backgroundColor: theme.COLORS.DARK_SUCCESS,\n    marginVertical: theme.SIZES.BASE,\n    borderWidth: 0,\n    minHeight: 50,\n    maxHeight: 50,\n    marginHorizontal: 16,\n    marginBottom: 16,\n    alignContent: 'center',\n    justifyContent: \"center\"\n  },\n  cardTitle: {\n    flex: 1,\n    flexWrap: 'wrap',\n    paddingBottom: 6\n  },\n  cardDescription: {\n    padding: theme.SIZES.BASE / 2\n  },\n  imageContainer: {\n    borderRadius: 3,\n    elevation: 1,\n    overflow: 'hidden',\n    resizeMode: \"cover\"\n  },\n  image: {},\n  horizontalImage: {\n    height: 122,\n    width: 'auto'\n  },\n  horizontalStyles: {\n    borderTopRightRadius: 0,\n    borderBottomRightRadius: 0\n  },\n  verticalStyles: {\n    borderBottomRightRadius: 0,\n    borderBottomLeftRadius: 0\n  },\n  fullImage: {\n    height: 200\n  },\n  shadow: {\n    shadowColor: theme.COLORS.BLACK,\n    shadowOffset: {\n      width: 0,\n      height: 2\n    },\n    shadowRadius: 4,\n    shadowOpacity: 0.1,\n    elevation: 2\n  }\n});","map":{"version":3,"sources":["C:/Users/emanu/Downloads/vendor-app-v3.0 (1)/screens/Orders.js"],"names":["React","useState","useEffect","Block","theme","Text","Language","Dimensions","get","width","API","TouchableOpacity","config","LoadingIndicator","Checkbox","moment","Location","Orders","navigation","location","setLocation","errorMsg","setErrorMsg","orders","setOrders","available","setAvailable","ordersLoaded","setOrdersLoaded","refreshing","setRefreshing","cardContainer","styles","card","shadow","requestPermissionsAsync","status","getCurrentPositionAsync","updateOrderLocation","ordersToUpdate","coords","forEach","orderToUpdate","updateDriverOrderLocation","id","latitude","longitude","ordersUpdateResponse","errorOrdersUpdateResponse","DRIVER_APP","getDriverOrders","ordersResponse","filter","e","last_status","alias","error","alert","getDriverStatus","statusResponse","console","log","working","VENDOR_APP","getVendorOrders","getClientOrders","onRefresh","useCallback","interval","setInterval","clearInterval","setActiveStatus","renderDriverActionBox","initValue","actioncard","color","margin","driverWorkingStatus","renderOrderItem","item","navigate","order","cardDescription","cardTitle","restorant","name","created","created_at","format","dateTimeFormat","length","parseFloat","order_price","delivery_price","currencySign","renderNoOrders","no_items","home","articles","map","StyleSheet","create","cartCheckout","backgroundColor","listStyle","padding","SIZES","BASE","paddingVertical","actionButtons","paddingHorizontal","paddingTop","paddingBottom","borderRadius","shadowColor","shadowOffset","height","shadowRadius","shadowOpacity","COLORS","WHITE","marginVertical","borderWidth","minHeight","marginBottom","DARK_SUCCESS","maxHeight","marginHorizontal","alignContent","justifyContent","flex","flexWrap","imageContainer","elevation","overflow","resizeMode","image","horizontalImage","horizontalStyles","borderTopRightRadius","borderBottomRightRadius","verticalStyles","borderBottomLeftRadius","fullImage","BLACK"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport {\n  StyleSheet,\n  Dimensions,\n  ScrollView,\n  RefreshControl\n} from \"react-native\";\nimport { Block, theme, Text, } from \"galio-framework\";\nimport {Language } from \"../constants\";\nconst { width, } = Dimensions.get(\"screen\");\nimport API from './../services/api'\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport config from './../config'\nimport {  LoadingIndicator } from 'react-native-expo-fancy-alerts';\nimport { Checkbox } from 'galio-framework';\nimport moment from \"moment\";\nimport * as Location from 'expo-location';\n\n\n\nfunction Orders({navigation}){\n\n    \n\n  //Location\n  const [location, setLocation] = useState(null);\n  const [errorMsg, setErrorMsg] = useState(null);\n\n  const [orders,setOrders]=useState([]);\n  const [available,setAvailable]=useState(false);\n  const [ordersLoaded,setOrdersLoaded]=useState(false);\n  const [refreshing, setRefreshing] = React.useState(false);\n  \n  const cardContainer = [styles.card, styles.shadow];\n\n\n    \n\n    \n  useEffect(() => {\n    (async () => {\n      let { status } = await Location.requestPermissionsAsync();\n      if (status !== 'granted') {\n        setErrorMsg('Permission to access location was denied');\n        return;\n      }\n\n      let location = await Location.getCurrentPositionAsync({});\n      setLocation(location);\n    })();\n  }, []);\n\n    function updateOrderLocation(ordersToUpdate){\n      if(location!=null&&location.coords){\n        ordersToUpdate.forEach(orderToUpdate => {\n          API.updateDriverOrderLocation(orderToUpdate.id,location.coords.latitude,location.coords.longitude,(ordersUpdateResponse)=>{},(errorOrdersUpdateResponse)=>{});\n        });\n      }\n      \n    }\n\n    useEffect(()=>{\n      if(config.DRIVER_APP){\n        //Driver get orders\n        API.getDriverOrders((ordersResponse)=>{\n          setOrders(ordersResponse);\n          updateOrderLocation(ordersResponse.filter(function (e) {\n            return e.last_status[0].alias==\"picked_up\";\n          }));\n          setOrdersLoaded(true);\n          setRefreshing(false);\n        },(error)=>{\n          setOrders([]);\n          setRefreshing(false);\n          setOrdersLoaded(true);\n          alert(error)\n        })\n\n        API.getDriverStatus((statusResponse)=>{\n          console.log(statusResponse);\n          setAvailable(statusResponse.working+\"\"==\"1\");\n        })\n\n\n      }if(config.VENDOR_APP){\n        //Vendor get orders\n        API.getVendorOrders((ordersResponse)=>{\n          setOrders(ordersResponse);\n          setOrdersLoaded(true);\n          setRefreshing(false);\n        },(error)=>{\n          setOrders([]);\n          setRefreshing(false);\n          setOrdersLoaded(true);\n          alert(error)\n        })\n      }else{\n        //Client get orders\n        API.getClientOrders((ordersResponse)=>{\n          setOrders(ordersResponse);\n          setOrdersLoaded(true);\n          setRefreshing(false);\n        })\n      }\n    },[refreshing])\n\n    const onRefresh = React.useCallback(() => {\n      setRefreshing(true);      \n    }, [refreshing]);\n\n    //Timer\n    useEffect(() => {\n      const interval = setInterval(() => {\n        setRefreshing(true);\n      }, 30000);\n      return () => clearInterval(interval);\n    }, []);\n\n\n    function setActiveStatus(status){\n      API.setActiveStatus(status,(statusResponse)=>{\n        console.log(\"Changed to ->\"+statusResponse);\n        setAvailable(statusResponse);\n      })\n    }\n\n    function renderDriverActionBox(initValue){\n      \n      if(config.DRIVER_APP){\n        if(initValue){\n          return (\n            <Block row={true} card flex style={styles.actioncard} >\n                <Block style={{\"some\":available}} flex space=\"between\" justifyContent=\"center\" paddingHorizontal={10} > \n                    <Checkbox key={\"true\"} onChange={setActiveStatus} initialValue={true} color=\"success\" labelStyle={{color:\"white\"}} color=\"success\"  checkboxStyle={{margin:10}} label={Language.driverWorkingStatus} />\n                </Block>\n            </Block>\n          )\n        }else{\n          return (\n            <Block row={true} card flex style={styles.actioncard} >\n                <Block style={{\"some\":available}} flex space=\"between\" justifyContent=\"center\" paddingHorizontal={10} > \n                    <Checkbox key={\"false\"} onChange={setActiveStatus} initialValue={false} color=\"success\" labelStyle={{color:\"white\"}} color=\"success\"  checkboxStyle={{margin:10}} label={Language.driverWorkingStatus} />\n                </Block>\n            </Block>\n          )\n        }\n        \n      }else{\n        return null\n      }\n      \n    }\n\n\n    function renderOrderItem(item){\n        return (\n        <Block row={true} card flex style={cardContainer}>\n          <TouchableOpacity onPress={()=>{\n            navigation.navigate(\"OrderDetails\",{order:item});\n          }}>\n             <Block flex space=\"between\" style={styles.cardDescription}>\n                <Text bold style={styles.cardTitle}>#{item.id} {item.restorant.name}</Text>\n                <Text muted  style={styles.cardTitle}>{Language.created+\": \"}{moment(item.created_at).format(config.dateTimeFormat)}</Text>\n                <Text muted bold style={styles.cardTitle}>{Language.status+\": \"}{item.status.length-1>-1?item.status[item.status.length-1].name:\"\"}</Text>\n                <Text bold style={styles.cardTitle}>{parseFloat(item.order_price)+parseFloat(item.delivery_price)}{config.currencySign}</Text>  \n            </Block>\n          </TouchableOpacity>\n           \n        </Block>)\n    }\n\n    function renderNoOrders(){\n      if(ordersLoaded&&orders.length==0){\n        return ( <Text muted>{Language.no_items}</Text>);\n      }else{\n        return null;\n      }\n    }\n\nreturn (\n<Block flex center style={styles.home}>\n  {\n    renderDriverActionBox(available)\n  }\n<ScrollView\n            showsVerticalScrollIndicator={false}\n            contentContainerStyle={styles.articles}\n            refreshControl={\n              <RefreshControl refreshing={refreshing} onRefresh={onRefresh} />\n            }\n            >\n                <Block flex  >\n                {\n                    orders.map((item)=>{\n                        return renderOrderItem(item)\n                    })\n                }\n                {renderNoOrders()}\n                \n            </Block>\n        </ScrollView>\n        <LoadingIndicator  visible={!ordersLoaded}/>\n</Block>\n)\n\n\n}\nexport default Orders;\n\nconst styles = StyleSheet.create({\n    cartCheckout: {\n      backgroundColor:\"white\"\n      },\n      listStyle:{\n          padding:theme.SIZES.BASE,\n      },\n    home: {\n      width: width,    \n    },\n    articles: {\n      width: width - theme.SIZES.BASE * 2,\n      paddingVertical: theme.SIZES.BASE,\n    },\n    actionButtons:{\n  \n      //width: 100,\n      backgroundColor: '#DCDCDC',\n      paddingHorizontal: 16,\n      paddingTop: 10,\n      paddingBottom:9.5,\n      borderRadius: 3,\n      shadowColor: \"rgba(0, 0, 0, 0.1)\",\n      shadowOffset: { width: 0, height: 2 },\n      shadowRadius: 4,\n      shadowOpacity: 1,\n    \n    },\n    card: {\n      backgroundColor: theme.COLORS.WHITE,\n      marginVertical: theme.SIZES.BASE,\n      borderWidth: 0,\n      minHeight: 114,\n      marginBottom: 16\n    },\n    actioncard: {\n      backgroundColor: theme.COLORS.DARK_SUCCESS,\n      marginVertical: theme.SIZES.BASE,\n      borderWidth: 0,\n      minHeight: 50,\n      maxHeight: 50,\n      marginHorizontal:16,\n      marginBottom: 16,\n      alignContent:'center',\n      justifyContent:\"center\"\n    },\n    cardTitle: {\n      flex: 1,\n      flexWrap: 'wrap',\n      paddingBottom: 6\n    },\n    cardDescription: {\n      padding: theme.SIZES.BASE / 2\n    },\n    imageContainer: {\n      borderRadius: 3,\n      elevation: 1,\n      overflow: 'hidden',\n      resizeMode: \"cover\"\n    },\n    image: {\n      // borderRadius: 3,\n    },\n    horizontalImage: {\n      height: 122,\n      width: 'auto',\n    },\n    horizontalStyles: {\n      borderTopRightRadius: 0,\n      borderBottomRightRadius: 0,\n    },\n    verticalStyles: {\n      borderBottomRightRadius: 0,\n      borderBottomLeftRadius: 0\n    },\n    fullImage: {\n      height: 200\n    },\n    shadow: {\n      shadowColor: theme.COLORS.BLACK,\n      shadowOffset: { width: 0, height: 2 },\n      shadowRadius: 4,\n      shadowOpacity: 0.1,\n      elevation: 2,\n    },\n  });\n"]},"metadata":{},"sourceType":"module"}